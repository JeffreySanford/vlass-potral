<div class="docs-container">
  <mat-toolbar color="primary" class="docs-toolbar">
    <mat-icon>description</mat-icon>
    <span>Project Documentation</span>
    <span class="spacer"></span>
    <a mat-button routerLink="/landing">
      <mat-icon>home</mat-icon>
      Home
    </a>
  </mat-toolbar>

  <div class="docs-hero">
    <h1>Documentation & Science Guides</h1>
    <p>Technical reference for the Cosmic Horizon AI Control Plane.</p>
  </div>

  @if (docId$ | async; as docId) {
    <div class="doc-viewer-container">
      <mat-card class="doc-viewer-card">
        @if (docViewModel$ | async; as model) {
          <mat-card-header>
            <mat-icon mat-card-avatar>article</mat-icon>
            <mat-card-title>{{ model.title }}</mat-card-title>
            <mat-card-subtitle>{{ model.sourcePath }}</mat-card-subtitle>
            <span class="spacer"></span>
            <button mat-icon-button routerLink="/docs" aria-label="Close document">
              <mat-icon>close</mat-icon>
            </button>
          </mat-card-header>
          <mat-card-content>
            @if (model.state === 'ready') {
              <article class="markdown-content" [innerHTML]="model.html"></article>
            } @else if (model.state === 'loading') {
              <div class="markdown-placeholder">
                <mat-icon>hourglass_empty</mat-icon>
                <p>Loading markdown for <code>{{ docId }}</code>...</p>
              </div>
            } @else {
              <div class="markdown-error" role="alert">
                <mat-icon>error</mat-icon>
                <p>{{ model.errorMessage }}</p>
              </div>
            }
          </mat-card-content>
        }
      </mat-card>
    </div>
  } @else {
    <div class="docs-grid">
      @for (section of sections; track section.title) {
        <mat-card class="section-card">
          <mat-card-header>
            <mat-icon mat-card-avatar>{{ section.icon }}</mat-icon>
            <mat-card-title>{{ section.title }}</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <mat-nav-list>
              @for (link of section.links; track link.label) {
                <a mat-list-item class="doc-link" [routerLink]="link.path">
                  <mat-icon matListItemIcon>article</mat-icon>
                  <div matListItemTitle>{{ link.label }}</div>
                  <mat-icon matListItemMeta>chevron_right</mat-icon>
                </a>
              }
            </mat-nav-list>
          </mat-card-content>
        </mat-card>
      }
    </div>
  }

  <div class="docs-footer">
    <mat-card class="disclaimer-card">
        <mat-card-content>
          <mat-icon>warning</mat-icon>
          <p><strong>Independence:</strong> Cosmic Horizon is an independent project by Jeffrey Sanford using public astronomy data; it is not affiliated with VLA/NRAO.</p>
          <p><strong>Status:</strong> The internal docs hub now renders curated markdown from the repository and includes ADR-style architecture links.</p>
        </mat-card-content>
      </mat-card>
  </div>
</div>
